<!doctype html><html lang=en><head><meta charset=utf-8><meta content="width=device-width,initial-scale=1,viewport-fit=cover" name=viewport><title>Solving Advent of Code 2021 Day 13 with a linear equation</title><meta content="steen's online burrow" name=description><meta content=Zola name=generator><meta content=strict-origin name=referrer><link href=https://sgt.hootr.club/assets/style.css rel=stylesheet><link title="RSS feed" href=/rss.xml rel=alternate type=application/rss+xml><link title="Atom feed" href=/atom.xml rel=alternate type=application/atom+xml><link href=/assets/icon/favicon-152.png rel=apple-touch-icon-precomposed><body class=main-parent><div class=main-parent><header class=main><h1 class=header-title><a href=https://sgt.hootr.club>STEENSBURROW</a></h1><nav><ul class=unstyled><li><a class=unstyled href=https://sgt.hootr.club/me/>me</a><li><a class=unstyled href=https://sgt.hootr.club/blog/>posts</a><li><a class=unstyled href=/rss.xml>rss</a><li><a class=unstyled href=https://sgt.hootr.club/meta/>meta</a></ul></nav></header><main class=main><article><header><h1 class=title>Solving Advent of Code 2021 Day 13 with a linear equation</h1><p class=subtitle>Published by <a href=/><i>steen</i></a> on <time datetime=2021-12-13>2021-12-13</time> tagged <a class=tag href=https://sgt.hootr.club/tags/math/>#math</a> <a class=tag href=https://sgt.hootr.club/tags/advent-of-code/>#advent-of-code</a></header><div class=content><p>This year I'm doing Advent of Code in Erlang. The data structures it provides are all immutable, so I have to be kinda clever if I don't want my solutions to run too slowly. This is my solution for <a rel="nofollow noreferrer external" class=external-link href=https://adventofcode.com/2021/day/13>Day 13: Transparent Origami</a>.<p>The first thing I noticed when I got the input was that all the folds are right down the middle, so I figured that instead of doing all the folds iteratively you could get the final position of a point on the paper just knowing the X and Y of the point and the X and Y offsets of the last folds.<p>Imagine that you have a 15x11 piece of paper.<pre class=giallo style=color:#d8dee9;background-color:#2e3440><code data-lang=plain><span class=giallo-l><span>...............</span></span>
<span class=giallo-l><span>...............</span></span>
<span class=giallo-l><span>...............</span></span>
<span class=giallo-l><span>...............</span></span>
<span class=giallo-l><span>...............</span></span>
<span class=giallo-l><span>...............</span></span>
<span class=giallo-l><span>...............</span></span>
<span class=giallo-l><span>...............</span></span>
<span class=giallo-l><span>...............</span></span>
<span class=giallo-l><span>...............</span></span>
<span class=giallo-l><span>...............</span></span></code></pre><p>And that the instructions tell you to:<ul><li>fold along y=5<li>fold along x=7<li>fold along y=2<li>fold along x=3</ul><p>If you were to fold that piece of paper following the instructions and then unfold it, you'd get a grid of 3x2 rectangles with a line of crease between each of them. Notice that the width and height of the rectangles are the same as the last x and y the paper was folded along.<pre class=giallo style=color:#d8dee9;background-color:#2e3440><code data-lang=plain><span class=giallo-l><span>...|...|...|...</span></span>
<span class=giallo-l><span>...|...|...|...</span></span>
<span class=giallo-l><span>---+---+---+---</span></span>
<span class=giallo-l><span>...|...|...|...</span></span>
<span class=giallo-l><span>...|...|...|...</span></span>
<span class=giallo-l><span>---+---+---+---</span></span>
<span class=giallo-l><span>...|...|...|...</span></span>
<span class=giallo-l><span>...|...|...|...</span></span>
<span class=giallo-l><span>---+---+---+---</span></span>
<span class=giallo-l><span>...|...|...|...</span></span>
<span class=giallo-l><span>...|...|...|...</span></span></code></pre><p>The key thing here is understanding how these rectangles will end up looking when the whole piece of paper is folded. The top left rectangle is unchanged, but the next one on the right will be <em>flipped horizontally</em>, and the next one on the right will be unchanged again. The first rectangle down from the top left will be <em>flipped vertically</em>, and the one on its right will end up <em>rotated by 180 degrees</em>, because it'll be flipped both horizontally and vertically.<p>Here's a visualization, where u = unchanged, h = flipped horizontally, v = flipped vertically and r = flipped both directions.<pre class=giallo style=color:#d8dee9;background-color:#2e3440><code data-lang=plain><span class=giallo-l><span>uuu|hhh|uuu|hhh</span></span>
<span class=giallo-l><span>uuu|hhh|uuu|hhh</span></span>
<span class=giallo-l><span>---+---+---+---</span></span>
<span class=giallo-l><span>vvv|rrr|vvv|rrr</span></span>
<span class=giallo-l><span>vvv|rrr|vvv|rrr</span></span>
<span class=giallo-l><span>---+---+---+---</span></span>
<span class=giallo-l><span>uuu|hhh|uuu|hhh</span></span>
<span class=giallo-l><span>uuu|hhh|uuu|hhh</span></span>
<span class=giallo-l><span>---+---+---+---</span></span>
<span class=giallo-l><span>vvv|rrr|vvv|rrr</span></span>
<span class=giallo-l><span>vvv|rrr|vvv|rrr</span></span></code></pre><p>So if you want to get the final X coordinate of a point in the 3rd rectangle right from the top left (the one at 2,0, if the first rectangle is 0,0), for example 10,0, you'd have to subtract the number of creases between that and the first rectangle, in this case 2, and then modulo by the width of the rectangle, which is 3, which gives you 2.<pre class=giallo style=color:#d8dee9;background-color:#2e3440><code data-lang=plain><span class=giallo-l><span>x = 10</span></span>
<span class=giallo-l><span>width = 3</span></span>
<span class=giallo-l><span>creases = 2</span></span>
<span class=giallo-l><span>final_x = (x - creases) % width</span></span></code></pre><p>If you want to get the final X coordinate of a point in the 2nd rectangle though, for example 0,4, you'd have to perform the same operations as above and then subtract it from the width of the rectangle minus 1, since the rectangle is flipped horizontally.<pre class=giallo style=color:#d8dee9;background-color:#2e3440><code data-lang=plain><span class=giallo-l><span>final_x = width - ((x - creases) % width) - 1</span></span></code></pre><p>What I did at this point was go on Wolfram Alpha to try and figure out a formula for getting the number of creases given a certain X. I'm sure you can find that out somehow. I didn't, but what I noticed was that the function I described above formed a certain shape...<pre class=giallo style=color:#d8dee9;background-color:#2e3440><code data-lang=plain><span class=giallo-l><span> |</span></span>
<span class=giallo-l><span> | 2 2     2 2     2</span></span>
<span class=giallo-l><span> |1   1   1   1   1</span></span>
<span class=giallo-l><span>-0-----0-0-----0-0--</span></span>
<span class=giallo-l><span> |</span></span></code></pre><p>If you plot the input X as the X of the graph and the expected output numbers as the Y, you get this funny looking graph as a result. If you want to know what position a certain number will end up in, just walk the X that many times and find the number at that position.<p>Some X positions are empty because that's where the creases are. If you put some pointy tips on those positions you'd end up with a proper <strong>triangle wave</strong>.<pre class=giallo style=color:#d8dee9;background-color:#2e3440><code data-lang=plain><span class=giallo-l><span> |</span></span>
<span class=giallo-l><span> |  ^       ^       ^</span></span>
<span class=giallo-l><span> | / \     / \     /</span></span>
<span class=giallo-l><span> |/   \   /   \   /</span></span>
<span class=giallo-l><span>-/-----\-/-----\-/---</span></span>
<span class=giallo-l><span>v|      v       v</span></span>
<span class=giallo-l><span> |</span></span></code></pre><p>So how do we use this knowledge to solve Day 13 of Advent of Code 2021? Well, you could look at the explanation on Wikipedia and translate the general formula into your favourite language, but that implies you can read math notation. Or you could google "triangle wave function programming" and find <a rel="nofollow noreferrer external" class=external-link href=https://stackoverflow.com/questions/1073606/is-there-a-one-line-function-that-generates-a-triangle-wave/22400799#22400799>this StackOverflow answer</a> and then copy and paste that in your code.<pre class=giallo style=color:#d8dee9;background-color:#2e3440><code data-lang=plain><span class=giallo-l><span>y = (A/P) * (P - abs(x % (2*P) - P))</span></span></code></pre><p>Since the amplitude and the period of the wave are the same (we always advance by 1) we can get rid of the first division. You'll also notice that the graph of the function for the width of the rectangle goes from -1 to 3 (an interval of 4), so we'll have to add 1 to both the width and the X to use this, and in the end we'll have to subtract 1 from the output to return it to the 0..2 interval we need.<p>This is what I ended up with:<pre class=giallo style=color:#d8dee9;background-color:#2e3440><code data-lang=plain><span class=giallo-l><span>x += 1</span></span>
<span class=giallo-l><span>width += 1</span></span>
<span class=giallo-l><span>final_x = (width - abs(x % (2 * width) - width)) - 1</span></span></code></pre><p>It runs pretty quickly <a rel="nofollow noreferrer external" class=external-link href=https://github.com/steinuil/code-challenges/blob/master/advent-of-code-2021/day_13.erl>even in Erlang</a>.</div></article></main><footer class=main><a class=logo href=/> <svg viewbox="0 0 79 49" version=1.1 xmlns=http://www.w3.org/2000/svg xmlns:svg=http://www.w3.org/2000/svg><title>Steen's online burrow</title><g fill=currentColor><g><path d="M 17,7 V 9 H 15 V 8 h -1 v 3 h 1 v 1 h 2 v 1 h 4 V 9 H 20 V 8 H 19 V 5 h 1 V 4 h 1 V 3 h 4 v 1 h -3 v 3 h 1 v 1 h 1 v 4 h -1 v 1 h -1 c 0,0 0,1 0,1 H 16 V 13 H 13 V 12 10 H 12 V 8 h 1 V 7 Z"/><path d="m 30,5 v 1 h 2 V 5 h 3 v 1 h -2 v 1 h -2 v 4 h -1 v 1 h -1 v 1 h -1 c 0,0 0,2 0,2 h -1 c 0,0 0,1 0,1 h -1 v -3 h 1 v -2 h 1 V 7 H 26 V 6 H 24 V 5 Z"/><path d="m 39,5 v 2 h -1 c 0,0 0,1 0,1 h -1 c 0,0 0,1 0,1 h -2 v 1 h 4 c 0,0 0,2 0,2 h -2 v -1 h -3 v 1 h -1 v 2 h 2 v -1 h 3 v 1 h 1 v 1 h 1 c 0,0 0,1 0,1 h -2 v -1 h -4 c 0,0 0,1 0,1 h -4 v -1 h 1 v -2 h 1 v -2 h 1 V 8 h 3 V 7 h 1 V 6 h 1 V 5 Z"/><path d="m 42,5 v 1 h 1 v 1 h 1 v 1 h 1 v 1 h 2 v 1 H 44 V 9 h -1 v 2 h 3 v 1 h -2 v 1 h -1 v 1 h 2 v -1 h 2 v 2 h -4 c 0,0 0,1 0,1 h -2 v -2 h 1 V 9 H 41 V 7 H 40 V 5 Z"/><path d="m 48,6 v 2 h 1 v 4 h 1 c 0,0 0,2 0,2 h -1 v 3 c 0,0 1,0 1,0 v -1 h 1 v -2 h 1 v -2 h 1 v 1 h 1 v 1 h 1 v 1 h 2 V 14 H 56 V 9 h 1 V 7 h 1 V 5 h 1 V 4 h 1 V 2 h -1 v 1 h -2 v 1 h -1 v 4 h -1 v 4 H 54 V 11 H 53 V 10 H 51 V 8 H 50 V 7 H 49 V 6 Z"/><path d="m 61,0 v 1 h 1 v 3 h 2 V 2 H 63 V 0 Z"/><path d="m 67,4 v 1 h -1 v 2 h 1 c 0,0 0,3 0,3 h -1 v 1 c 0,0 -4,0 -4,0 v -1 h 2 V 9 h 1 V 8 H 64 V 5 h 1 V 4 Z"/></g><g><path d="m 26,22 h 3 v -1 h -3 z"/><path d="m 31,20 v 1 h 1 v 1 h 1 v -2 z m 1,2 h -1 v -1 h -1 v 2 h 2 z"/><path d="m 34,20 v 3 h 1 v -2 h 1 v 2 h 1 v -2 h -1 v -1 z"/><path d="m 38,19 v 4 h 1 v -4 z"/><path d="m 40,19 v 1 h 1 v -1 z"/><path d="m 40,21 v 2 h 1 v -2 z"/><path d="m 42,23 v -3 h 2 v 1 h 1 c 0,0 0,2 0,2 h -1 v -2 h -1 v 2 z"/><path d="m 46,21 v 2 h 1 v 1 h 1 v -1 h -1 v -2 h 1 v 1 h 1 v -2 h -2 v 1 z"/><path d="m 50,21 c 0,0 0,1 0,1 h 3 v -1 z"/></g><g><path d="m 5,26 v 1 H 4 v 6 H 3 v 7 H 2 v 4 H 1 v 2 H 0 v 3 h 6 v -1 h 2 v -1 h 2 v -1 h 2 v -1 h 2 v -4 h -1 v -1 h -1 v -2 h 1 v -2 h 1 v -1 h 1 v -1 h 1 V 28 H 12 V 27 H 9 v -1 z m 2,4 h 2 v 1 h 3 v 2 h -1 v 1 h -1 v 1 H 9 v 1 H 8 v 1 H 6 V 36 H 7 Z M 6,41 h 2 v 1 h 2 v 1 H 8 v 1 H 6 v 1 H 5 v -2 h 1 z"/><path d="m 17,26 v 3 h 1 v 2 h -1 v 5 h -1 v 4 h -1 v 4 h 1 v 2 h 9 v -1 h 1 v -3 h 1 V 25 h -4 v 5 h 1 v 9 h -1 v 3 h -1 v 1 h -3 v -4 h 1 v -5 h 1 v -8 z"/><path d="m 28,27 v 5 h 1 v 2 h -1 v 14 h 3 V 38 h 1 v 4 h 1 v 4 h 1 v 2 h 3 v -5 h -1 v -4 h -1 v -5 h 3 v -6 h -2 v -1 z m 4,3 h 1 v 1 h -1 z"/><path d="m 40,27 v 21 h 3 V 37 h 1 v 1 h 1 v 1 h 1 v 1 h 1 v 2 h 1 v 1 h 1 v 2 h 4 v -3 h -1 v -1 h -1 v -2 h -1 v -1 h -1 v -1 h -1 v -9 h -2 v -1 z m 3,4 h 2 v 1 h -1 v 1 h -1 z"/><path d="m 52,27 v 1 h -1 v 1 h -1 v 7 h 1 v 1 h 1 v 1 h 1 v 1 h 5 v -1 h 2 v -1 h 1 v -8 h -1 v -1 h -4 v -1 z m 2,4 h 3 v 1 h 1 v 2 h -1 v 1 h -2 v -1 h -1 v -1 h -1 v -1 h 1 z"/><path d="m 63,25 v 4 h 1 v 16 h 4 v -1 h 1 v -1 h 1 v -2 h 2 v 1 h 2 v 1 h 1 v 1 h 4 v -5 h -1 v -3 h -1 v -2 h -1 v -2 h -1 v -2 h -1 v -2 h -1 v -3 h -1 v -1 h -3 v 4 h 1 v 3 h 1 v 2 h 1 v 2 h 1 v 2 h 1 v 1 h -1 v -1 h -4 v 1 H 67 V 26 h -1 v -1 z"/></g></g></svg> </a><div class=blurb>There is no end though there is a start in the past — Infinity.<br> It speaks, it ruins, and it goes though it consumes the soul — Finite.<br> Only the person who has wisdom can read the most foolish one from the history.<br> The daemon that lives in the machine doesn't understand the daemon that lives in the brain.<br> It is funnier that man exceeds the speed of light than machine start writing on a net.<br> It can be said that this is final ultimatum from the people who can think.</div></footer></div>