<!doctype html><html lang=en><head><meta charset=utf-8><meta content="width=device-width,initial-scale=1,viewport-fit=cover" name=viewport><title>What the hell did I do this week, anyway?</title><meta content="steen's online burrow" name=description><meta content=Zola name=generator><meta content=strict-origin name=referrer><link href=https://sgt.hootr.club/assets/style.css rel=stylesheet><link title="RSS feed" href=/rss.xml rel=alternate type=application/rss+xml><link title="Atom feed" href=/atom.xml rel=alternate type=application/atom+xml><link href=/assets/icon/favicon-152.png rel=apple-touch-icon-precomposed><body class=main-parent><div class=main-parent><header class=main><h1 class=header-title><a href=https://sgt.hootr.club>STEENSBURROW</a></h1><nav><ul class=unstyled><li><a class=unstyled href=https://sgt.hootr.club/me/>me</a><li><a class=unstyled href=https://sgt.hootr.club/blog/>posts</a><li><a class=unstyled href=https://sgt.hootr.club/meta/>meta</a></ul></nav></header><main class=main><article><header><h1 class=title>What the hell did I do this week, anyway?</h1><p class=subtitle>Published by <a href=/><i>steen</i></a> on <time datetime=2018-01-22>2018-01-22</time> tagged <a class=tag href=https://sgt.hootr.club/tags/emacs/>#emacs</a> <a class=tag href=https://sgt.hootr.club/tags/urweb/>#urweb</a></header><div class=content><p>Welcome to the first installation of <strong>What The Hell Did I Do This Week Anyway</strong>, the low-effort blog series where I write about random stuff that I did in the last few days.<h2 id=emacs-strikes-again-or-the-stages-of-software-grief>Emacs strikes again, or the stages of software grief</h2><p>This week I watched a bunch of Jonathan Blow's <a rel="nofollow noreferrer" class=external-link href=https://www.youtube.com/user/jblow888/videos>screencasts</a>, where he talks about the language he's writing and all that business. It looks nice. Lately he's working on libraries, and I wish he'd take a hint from ML functors when designing modules and module options, as he's talked about in the libraries discussion stream. Expose a fucking module for configuration and make it return the full thing, using strings for that just feels painful.<p>Anyway, he uses emacs for all the programming in his stream, save for debugging a bunch of stuff in C++, and looking at emacs for all this time has reawakened the little bug in my brain that tells me to start using emacs already. I use nvim for everything, but I'm kind of horrified by the whole vimscript business and at the very least elisp is a saner language.<br> Screw learning all those keybinds though. I've spent years on vim and I think the modal editing business is a much better fit to editing code than the big mess of emacs keybinds. Screw using evil too, though, because emacs is not vi and I don't think it should be. Screw all the minor modes that kind of mimic vi but also kind of don't, and screw a lot of the packages that emacs comes preloaded with.<p>I downloaded the emacs source and managed to compile temacs, which is the "bare" version of emacs that gets filled in with all the preloaded libraries and elisp code, and then gets "dumped" to the final emacs executable we all know and fear. I recommend <a rel="nofollow noreferrer" class=external-link href=http://emacshorrors.com/posts/unexecute.html>this</a> for the gory details on this horrifying process. I think there might be a few steps in the build process that should happen after building temacs but before actually loading temacs and dumping it to emacs, because I can't get the damn thing to work. I invoke temacs and tell it to load <code>loadup.el</code> (the file that loads all the plugins and tells emacs to dump itself) but it keeps failing with some error message or another. First it's pcase, then it's require, and who knows what the next will be. Despite its reputation for being so hackable, this part of the build process sure is not, and if it is it's <em>very</em> undocumented.<p>I started writing my own loadup file in hopes of getting it right, but I ran into some files that supposedly provide Common Lisp support which for some reason <code>require</code> each other. At this point I gave up, because I was already way past the treshold of time and effort I wanted to allocate to emacs that evening. Thanks, jwz.<p>The next step in the stages of software grief is starting to implement your own version, because you're <strong>so</strong> done with whatever you were using before and its alternatives and how hard could it possibly be anyway. Which is exactly what I did, as soon as I remembered that Racket came with a perfectly good library for drawing stuff on the screen, on top of which they implemented a GUI library and the very nice editor/IDE DrRacket. I looked up how Racket implements the editor window, and the results weren't exactly what I'd call readable or encouragings, after messing a bit with the <code>canvas%</code> class I decided to give up for the moment.<p>Which is where I reached the last stage of software grief, in which I changed my vim colorscheme to <a rel="nofollow noreferrer" class=external-link href=https://github.com/ajmwagar/vim-deus>deus</a> and called it a day.<h2 id=eight-whole-bytes-of-security>Eight whole bytes of security</h2><p>I was working on my Ur/Web imageboard, when I noticed that I accidentally typed "passwords" instead of "password" and still managed to log in. I looked up the implementation of <code>crypt</code> (the only password hashing function provided in Ur/Web) in the runtime library and discovered that it uses OpenSSL's <code>DES_crypt</code>, which clips passwords to 8 characters (!) and has been deemed obsolete for decades now (with good reason). I don't know what the production-class Ur/Web applications do for password hashing, but thankfully searching for <code>crypt</code> in both the Bazqux Reader and UPO repos doesn't turn up any results. Either way, nobody had bothered to write Ur/Web bindings to a better password hashing algorithm, so I figured I'd do it.<p>The result is <a rel="nofollow noreferrer" class=external-link href=https://github.com/steinuil/urweb-bcrypt>this library</a>, which uses Solar Designer's implementation of the algorithm. It only exposes two functions, so integrating it with my imageboard only took something like two minutes. I'm quite satisfied with it, though it could probably use some tests.<p>The other result is that I've submitted a PR with a comment on the <code>crypt</code> function in the Ur/Web standard library, essentially explaining that it's insecure and you should probably consider an alternative (such as my library).</div></article></main><footer class=main><a class=logo href=/> <svg viewbox="0 0 79 49" version=1.1 xmlns=http://www.w3.org/2000/svg xmlns:svg=http://www.w3.org/2000/svg><title>Steen's online burrow</title><g fill=currentColor><g><path d="M 17,7 V 9 H 15 V 8 h -1 v 3 h 1 v 1 h 2 v 1 h 4 V 9 H 20 V 8 H 19 V 5 h 1 V 4 h 1 V 3 h 4 v 1 h -3 v 3 h 1 v 1 h 1 v 4 h -1 v 1 h -1 c 0,0 0,1 0,1 H 16 V 13 H 13 V 12 10 H 12 V 8 h 1 V 7 Z"/><path d="m 30,5 v 1 h 2 V 5 h 3 v 1 h -2 v 1 h -2 v 4 h -1 v 1 h -1 v 1 h -1 c 0,0 0,2 0,2 h -1 c 0,0 0,1 0,1 h -1 v -3 h 1 v -2 h 1 V 7 H 26 V 6 H 24 V 5 Z"/><path d="m 39,5 v 2 h -1 c 0,0 0,1 0,1 h -1 c 0,0 0,1 0,1 h -2 v 1 h 4 c 0,0 0,2 0,2 h -2 v -1 h -3 v 1 h -1 v 2 h 2 v -1 h 3 v 1 h 1 v 1 h 1 c 0,0 0,1 0,1 h -2 v -1 h -4 c 0,0 0,1 0,1 h -4 v -1 h 1 v -2 h 1 v -2 h 1 V 8 h 3 V 7 h 1 V 6 h 1 V 5 Z"/><path d="m 42,5 v 1 h 1 v 1 h 1 v 1 h 1 v 1 h 2 v 1 H 44 V 9 h -1 v 2 h 3 v 1 h -2 v 1 h -1 v 1 h 2 v -1 h 2 v 2 h -4 c 0,0 0,1 0,1 h -2 v -2 h 1 V 9 H 41 V 7 H 40 V 5 Z"/><path d="m 48,6 v 2 h 1 v 4 h 1 c 0,0 0,2 0,2 h -1 v 3 c 0,0 1,0 1,0 v -1 h 1 v -2 h 1 v -2 h 1 v 1 h 1 v 1 h 1 v 1 h 2 V 14 H 56 V 9 h 1 V 7 h 1 V 5 h 1 V 4 h 1 V 2 h -1 v 1 h -2 v 1 h -1 v 4 h -1 v 4 H 54 V 11 H 53 V 10 H 51 V 8 H 50 V 7 H 49 V 6 Z"/><path d="m 61,0 v 1 h 1 v 3 h 2 V 2 H 63 V 0 Z"/><path d="m 67,4 v 1 h -1 v 2 h 1 c 0,0 0,3 0,3 h -1 v 1 c 0,0 -4,0 -4,0 v -1 h 2 V 9 h 1 V 8 H 64 V 5 h 1 V 4 Z"/></g><g><path d="m 26,22 h 3 v -1 h -3 z"/><path d="m 31,20 v 1 h 1 v 1 h 1 v -2 z m 1,2 h -1 v -1 h -1 v 2 h 2 z"/><path d="m 34,20 v 3 h 1 v -2 h 1 v 2 h 1 v -2 h -1 v -1 z"/><path d="m 38,19 v 4 h 1 v -4 z"/><path d="m 40,19 v 1 h 1 v -1 z"/><path d="m 40,21 v 2 h 1 v -2 z"/><path d="m 42,23 v -3 h 2 v 1 h 1 c 0,0 0,2 0,2 h -1 v -2 h -1 v 2 z"/><path d="m 46,21 v 2 h 1 v 1 h 1 v -1 h -1 v -2 h 1 v 1 h 1 v -2 h -2 v 1 z"/><path d="m 50,21 c 0,0 0,1 0,1 h 3 v -1 z"/></g><g><path d="m 5,26 v 1 H 4 v 6 H 3 v 7 H 2 v 4 H 1 v 2 H 0 v 3 h 6 v -1 h 2 v -1 h 2 v -1 h 2 v -1 h 2 v -4 h -1 v -1 h -1 v -2 h 1 v -2 h 1 v -1 h 1 v -1 h 1 V 28 H 12 V 27 H 9 v -1 z m 2,4 h 2 v 1 h 3 v 2 h -1 v 1 h -1 v 1 H 9 v 1 H 8 v 1 H 6 V 36 H 7 Z M 6,41 h 2 v 1 h 2 v 1 H 8 v 1 H 6 v 1 H 5 v -2 h 1 z"/><path d="m 17,26 v 3 h 1 v 2 h -1 v 5 h -1 v 4 h -1 v 4 h 1 v 2 h 9 v -1 h 1 v -3 h 1 V 25 h -4 v 5 h 1 v 9 h -1 v 3 h -1 v 1 h -3 v -4 h 1 v -5 h 1 v -8 z"/><path d="m 28,27 v 5 h 1 v 2 h -1 v 14 h 3 V 38 h 1 v 4 h 1 v 4 h 1 v 2 h 3 v -5 h -1 v -4 h -1 v -5 h 3 v -6 h -2 v -1 z m 4,3 h 1 v 1 h -1 z"/><path d="m 40,27 v 21 h 3 V 37 h 1 v 1 h 1 v 1 h 1 v 1 h 1 v 2 h 1 v 1 h 1 v 2 h 4 v -3 h -1 v -1 h -1 v -2 h -1 v -1 h -1 v -1 h -1 v -9 h -2 v -1 z m 3,4 h 2 v 1 h -1 v 1 h -1 z"/><path d="m 52,27 v 1 h -1 v 1 h -1 v 7 h 1 v 1 h 1 v 1 h 1 v 1 h 5 v -1 h 2 v -1 h 1 v -8 h -1 v -1 h -4 v -1 z m 2,4 h 3 v 1 h 1 v 2 h -1 v 1 h -2 v -1 h -1 v -1 h -1 v -1 h 1 z"/><path d="m 63,25 v 4 h 1 v 16 h 4 v -1 h 1 v -1 h 1 v -2 h 2 v 1 h 2 v 1 h 1 v 1 h 4 v -5 h -1 v -3 h -1 v -2 h -1 v -2 h -1 v -2 h -1 v -2 h -1 v -3 h -1 v -1 h -3 v 4 h 1 v 3 h 1 v 2 h 1 v 2 h 1 v 2 h 1 v 1 h -1 v -1 h -4 v 1 H 67 V 26 h -1 v -1 z"/></g></g></svg> </a><div class=blurb>There is no end though there is a start in the past — Infinity.<br> It speaks, it ruins, and it goes though it consumes the soul — Finite.<br> Only the person who has wisdom can read the most foolish one from the history.<br> The daemon that lives in the machine doesn't understand the daemon that lives in the brain.<br> It is funnier that man exceeds the speed of light than machine start writing on a net.<br> It can be said that this is final ultimatum from the people who can think.</div></footer></div>