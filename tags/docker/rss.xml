<?xml version="1.0" encoding="UTF-8"?>
<rss xmlns:atom="http://www.w3.org/2005/Atom" version="2.0">
    <channel>
      <title>steen&#x27;s burrow - docker</title>
      <link>https://sgt.hootr.club</link>
      <description>steen&#x27;s online burrow</description>
      <generator>Zola</generator>
      <language>en-us</language>
      <atom:link href="https://sgt.hootr.club/tags/docker/rss.xml" rel="self" type="application/rss+xml"/>
      <lastBuildDate>Fri, 12 Dec 2025 00:00:00 +0000</lastBuildDate>
      <item>
          <title>Building smaller Docker images faster</title>
          <pubDate>Fri, 12 Dec 2025 00:00:00 +0000</pubDate>
          <author>steen</author>
          <link>https://sgt.hootr.club/blog/docker-protips/</link>
          <guid>https://sgt.hootr.club/blog/docker-protips/</guid>
          <description xml:base="https://sgt.hootr.club/blog/docker-protips/">&lt;p&gt;I&#x27;ve been tasked (more or less) with building the first Go service at &lt;code&gt;$DAYJOB&lt;&#x2F;code&gt;, which is almost exclusively a Python shop. Why Go of all languages? Well, some of my coworkers are big fans of the gopher, it&#x27;s an easy language, it&#x27;s attached to one of the big companies, and it&#x27;s much faster than Python, so I feel more comfortable pushing for this rather than Rust or (sadly) Nix.&lt;&#x2F;p&gt;
&lt;p&gt;The project that recently fell onto my lap is basically RCE-as-a-service, and it just so happens that &lt;a class=&quot;external-link&quot; rel=&quot;nofollow noreferrer external&quot; href=&quot;https:&#x2F;&#x2F;starlark-lang.org&#x2F;&quot;&gt;one of the few languages&lt;&#x2F;a&gt; that I would feel comfortable letting users execute remotely on our servers has &lt;a class=&quot;external-link&quot; rel=&quot;nofollow noreferrer external&quot; href=&quot;https:&#x2F;&#x2F;github.com&#x2F;google&#x2F;starlark-go&quot;&gt;a Go implementation&lt;&#x2F;a&gt;, which is as good an excuse as any to take a break from the usual snekslop.&lt;&#x2F;p&gt;
&lt;p&gt;I still haven&#x27;t convinced anybody here to get on the Nix train, so after a short stint of building the project and the OCI images with a recursive cycle of Make and Nix, I breathed a heavy sigh and dropped it for Docker and Docker Compose, which is what we generally use here.&lt;&#x2F;p&gt;
&lt;aside class=&quot;note&quot;&gt;
  &lt;p&gt;And just between you and me, I don&#x27;t think we use them very well. CI is painfully slow and we all just kinda live with it because figuring out how the damn &lt;code&gt;Dockerfile&lt;&#x2F;code&gt; works sucks even more.&lt;&#x2F;p&gt;

&lt;&#x2F;aside&gt;
&lt;p&gt;Which is a shame, because Nix is pretty good at building OCI images. This is all the code you need to create a minimal image that contains only your service and nothing else, not even &lt;code&gt;&#x2F;bin&#x2F;sh&lt;&#x2F;code&gt;.&lt;&#x2F;p&gt;
&lt;pre class=&quot;giallo&quot; style=&quot;color: #D8DEE9; background-color: #2E3440;&quot;&gt;&lt;code data-lang=&quot;nix&quot;&gt;&lt;span class=&quot;giallo-l&quot;&gt;&lt;span style=&quot;color: #ECEFF4;&quot;&gt;{&lt;&#x2F;span&gt;&lt;span&gt; pkgs&lt;&#x2F;span&gt;&lt;span style=&quot;color: #81A1C1;&quot;&gt; ?&lt;&#x2F;span&gt;&lt;span style=&quot;color: #88C0D0;&quot;&gt; import&lt;&#x2F;span&gt;&lt;span style=&quot;color: #A3BE8C;&quot;&gt; &amp;lt;nixpkgs&amp;gt;&lt;&#x2F;span&gt;&lt;span style=&quot;color: #ECEFF4;&quot;&gt; {} }:&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;
&lt;span class=&quot;giallo-l&quot;&gt;&lt;span&gt;pkgs&lt;&#x2F;span&gt;&lt;span style=&quot;color: #81A1C1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span&gt;dockerTools&lt;&#x2F;span&gt;&lt;span style=&quot;color: #81A1C1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span&gt;streamLayeredImage&lt;&#x2F;span&gt;&lt;span style=&quot;color: #ECEFF4;&quot;&gt; {&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;
&lt;span class=&quot;giallo-l&quot;&gt;&lt;span style=&quot;color: #8FBCBB;&quot;&gt;  name&lt;&#x2F;span&gt;&lt;span style=&quot;color: #81A1C1;&quot;&gt; =&lt;&#x2F;span&gt;&lt;span style=&quot;color: #ECEFF4;&quot;&gt; &amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color: #A3BE8C;&quot;&gt;someimage&lt;&#x2F;span&gt;&lt;span style=&quot;color: #ECEFF4;&quot;&gt;&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color: #81A1C1;&quot;&gt;;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;
&lt;span class=&quot;giallo-l&quot;&gt;&lt;span style=&quot;color: #8FBCBB;&quot;&gt;  tag&lt;&#x2F;span&gt;&lt;span style=&quot;color: #81A1C1;&quot;&gt; =&lt;&#x2F;span&gt;&lt;span style=&quot;color: #ECEFF4;&quot;&gt; &amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color: #A3BE8C;&quot;&gt;latest&lt;&#x2F;span&gt;&lt;span style=&quot;color: #ECEFF4;&quot;&gt;&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color: #81A1C1;&quot;&gt;;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;
&lt;span class=&quot;giallo-l&quot;&gt;&lt;span style=&quot;color: #8FBCBB;&quot;&gt;  config&lt;&#x2F;span&gt;&lt;span&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color: #8FBCBB;&quot;&gt;Cmd&lt;&#x2F;span&gt;&lt;span style=&quot;color: #81A1C1;&quot;&gt; =&lt;&#x2F;span&gt;&lt;span style=&quot;color: #ECEFF4;&quot;&gt; [&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;
&lt;span class=&quot;giallo-l&quot;&gt;&lt;span style=&quot;color: #ECEFF4;&quot;&gt;    &amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color: #81A1C1;&quot;&gt;${&lt;&#x2F;span&gt;&lt;span&gt;pkgs&lt;&#x2F;span&gt;&lt;span style=&quot;color: #81A1C1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span&gt;hello&lt;&#x2F;span&gt;&lt;span style=&quot;color: #81A1C1;&quot;&gt;}&lt;&#x2F;span&gt;&lt;span style=&quot;color: #A3BE8C;&quot;&gt;&#x2F;bin&#x2F;hello&lt;&#x2F;span&gt;&lt;span style=&quot;color: #ECEFF4;&quot;&gt;&amp;quot;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;
&lt;span class=&quot;giallo-l&quot;&gt;&lt;span style=&quot;color: #ECEFF4;&quot;&gt;  ]&lt;&#x2F;span&gt;&lt;span style=&quot;color: #81A1C1;&quot;&gt;;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;
&lt;span class=&quot;giallo-l&quot;&gt;&lt;span style=&quot;color: #ECEFF4;&quot;&gt;}&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;You can build that with &lt;code&gt;nix-build docker-test.nix&lt;&#x2F;code&gt; and inside &lt;code&gt;.&#x2F;result&lt;&#x2F;code&gt; you&#x27;ll find a script that generates the image&#x27;s tarball. Load it up with &lt;code&gt;.&#x2F;result | docker load&lt;&#x2F;code&gt; and Docker will report a new image called &lt;code&gt;someimage:latest&lt;&#x2F;code&gt; when you run &lt;code&gt;docker image ls&lt;&#x2F;code&gt;. It&#x27;s only 45.8MB, and most of that is taken up by glibc.&lt;&#x2F;p&gt;
&lt;p&gt;But what if I told you that you can get more or less the same result with a simple &lt;code&gt;Dockerfile&lt;&#x2F;code&gt; if you know what you&#x27;re doing? Especially if you&#x27;re building a static executable, which Go famously does (at least when you set &lt;code&gt;CGO_ENABLED=0&lt;&#x2F;code&gt;) and if you&#x27;re willing to sacrifice a few affordances. Who needs coreutils anyway?&lt;&#x2F;p&gt;
&lt;p&gt;In this post I&#x27;ll show you a few tricks I found while striving to make small and fast-building images. I&#x27;m not an expert in Docker by any stretch so maybe you know all of this stuff already, but perhaps you might learn something new.&lt;&#x2F;p&gt;
&lt;h2 id=&quot;a-barebones-image&quot;&gt;A barebones image&lt;&#x2F;h2&gt;
&lt;p&gt;I&#x27;m using &lt;a class=&quot;external-link&quot; rel=&quot;nofollow noreferrer external&quot; href=&quot;https:&#x2F;&#x2F;github.com&#x2F;pressly&#x2F;goose&quot;&gt;&lt;code&gt;goose&lt;&#x2F;code&gt;&lt;&#x2F;a&gt; for database migrations. I configured the &lt;code&gt;docker-compose.yml&lt;&#x2F;code&gt; to run its container just after the database has started and before the actual service runs, and since it&#x27;s a very small self-contained tool I figured I could try to make the image as small and quick to build as possible. Let me show you the relevant part of the &lt;code&gt;docker-compose.yml&lt;&#x2F;code&gt; first:&lt;&#x2F;p&gt;
&lt;pre class=&quot;giallo&quot; style=&quot;color: #D8DEE9; background-color: #2E3440;&quot;&gt;&lt;code data-lang=&quot;yaml&quot;&gt;&lt;span class=&quot;giallo-l&quot;&gt;&lt;span style=&quot;color: #8FBCBB;&quot;&gt;services&lt;&#x2F;span&gt;&lt;span style=&quot;color: #ECEFF4;&quot;&gt;:&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;
&lt;span class=&quot;giallo-l&quot;&gt;&lt;span style=&quot;color: #8FBCBB;&quot;&gt;  migrate&lt;&#x2F;span&gt;&lt;span style=&quot;color: #ECEFF4;&quot;&gt;:&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;
&lt;span class=&quot;giallo-l&quot;&gt;&lt;span style=&quot;color: #8FBCBB;&quot;&gt;    image&lt;&#x2F;span&gt;&lt;span style=&quot;color: #ECEFF4;&quot;&gt;:&lt;&#x2F;span&gt;&lt;span style=&quot;color: #A3BE8C;&quot;&gt; migrate:latest&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;
&lt;span class=&quot;giallo-l&quot;&gt;&lt;span style=&quot;color: #8FBCBB;&quot;&gt;    pull_policy&lt;&#x2F;span&gt;&lt;span style=&quot;color: #ECEFF4;&quot;&gt;:&lt;&#x2F;span&gt;&lt;span style=&quot;color: #A3BE8C;&quot;&gt; build&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;
&lt;span class=&quot;giallo-l&quot;&gt;&lt;span style=&quot;color: #8FBCBB;&quot;&gt;    build&lt;&#x2F;span&gt;&lt;span style=&quot;color: #ECEFF4;&quot;&gt;:&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;
&lt;span class=&quot;giallo-l&quot;&gt;&lt;span style=&quot;color: #8FBCBB;&quot;&gt;      context&lt;&#x2F;span&gt;&lt;span style=&quot;color: #ECEFF4;&quot;&gt;:&lt;&#x2F;span&gt;&lt;span style=&quot;color: #A3BE8C;&quot;&gt; https:&#x2F;&#x2F;github.com&#x2F;pressly&#x2F;goose.git#v3.26.0&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;
&lt;span class=&quot;giallo-l&quot;&gt;&lt;span style=&quot;color: #8FBCBB;&quot;&gt;      dockerfile&lt;&#x2F;span&gt;&lt;span style=&quot;color: #ECEFF4;&quot;&gt;:&lt;&#x2F;span&gt;&lt;span style=&quot;color: #A3BE8C;&quot;&gt; $PWD&#x2F;Dockerfile.migrate&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;
&lt;span class=&quot;giallo-l&quot;&gt;&lt;span style=&quot;color: #8FBCBB;&quot;&gt;    environment&lt;&#x2F;span&gt;&lt;span style=&quot;color: #ECEFF4;&quot;&gt;:&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;
&lt;span class=&quot;giallo-l&quot;&gt;&lt;span style=&quot;color: #8FBCBB;&quot;&gt;      GOOSE_DBSTRING&lt;&#x2F;span&gt;&lt;span style=&quot;color: #ECEFF4;&quot;&gt;:&lt;&#x2F;span&gt;&lt;span style=&quot;color: #A3BE8C;&quot;&gt; postgresql:&#x2F;&#x2F;AzureDiamond:hunter2@db:5432&#x2F;bobby&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;
&lt;span class=&quot;giallo-l&quot;&gt;&lt;span style=&quot;color: #8FBCBB;&quot;&gt;      GOOSE_MIGRATION_DIR&lt;&#x2F;span&gt;&lt;span style=&quot;color: #ECEFF4;&quot;&gt;:&lt;&#x2F;span&gt;&lt;span style=&quot;color: #A3BE8C;&quot;&gt; &#x2F;migrations&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;
&lt;span class=&quot;giallo-l&quot;&gt;&lt;span style=&quot;color: #8FBCBB;&quot;&gt;      GOOSE_DRIVER&lt;&#x2F;span&gt;&lt;span style=&quot;color: #ECEFF4;&quot;&gt;:&lt;&#x2F;span&gt;&lt;span style=&quot;color: #A3BE8C;&quot;&gt; postgres&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;
&lt;span class=&quot;giallo-l&quot;&gt;&lt;span style=&quot;color: #8FBCBB;&quot;&gt;    depends_on&lt;&#x2F;span&gt;&lt;span style=&quot;color: #ECEFF4;&quot;&gt;:&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;
&lt;span class=&quot;giallo-l&quot;&gt;&lt;span style=&quot;color: #8FBCBB;&quot;&gt;      db&lt;&#x2F;span&gt;&lt;span style=&quot;color: #ECEFF4;&quot;&gt;:&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;
&lt;span class=&quot;giallo-l&quot;&gt;&lt;span style=&quot;color: #8FBCBB;&quot;&gt;        condition&lt;&#x2F;span&gt;&lt;span style=&quot;color: #ECEFF4;&quot;&gt;:&lt;&#x2F;span&gt;&lt;span style=&quot;color: #A3BE8C;&quot;&gt; service_started&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;
&lt;span class=&quot;giallo-l&quot;&gt;&lt;span style=&quot;color: #8FBCBB;&quot;&gt;    volumes&lt;&#x2F;span&gt;&lt;span style=&quot;color: #ECEFF4;&quot;&gt;:&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;
&lt;span class=&quot;giallo-l&quot;&gt;&lt;span style=&quot;color: #ECEFF4;&quot;&gt;      -&lt;&#x2F;span&gt;&lt;span style=&quot;color: #A3BE8C;&quot;&gt; .&#x2F;migrations:&#x2F;migrations&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;&lt;a class=&quot;external-link&quot; rel=&quot;nofollow noreferrer external&quot; href=&quot;https:&#x2F;&#x2F;docs.docker.com&#x2F;build&#x2F;concepts&#x2F;context&#x2F;&quot;&gt;The &lt;code&gt;build.context&lt;&#x2F;code&gt; parameter&lt;&#x2F;a&gt; specifies the &quot;set of files&quot; that are available from the host while building a Docker image. It&#x27;s the parameter that you pass after &lt;code&gt;docker build&lt;&#x2F;code&gt;, generally &lt;code&gt;.&lt;&#x2F;code&gt; (the PWD). Here I specified a GitHub URL with a tag, so when I&#x27;m referring to &lt;code&gt;.&lt;&#x2F;code&gt; in the &lt;code&gt;Dockerfile&lt;&#x2F;code&gt; above I get the root of the &lt;code&gt;goose&lt;&#x2F;code&gt; project on that tag&#x27;s commit. I didn&#x27;t know Docker could do that!&lt;&#x2F;p&gt;
&lt;p&gt;The &lt;code&gt;build.dockerfile&lt;&#x2F;code&gt; path includes &lt;code&gt;$PWD&lt;&#x2F;code&gt; because even if Docker itself can refer to Dockerfiles outside of its context, &lt;a class=&quot;external-link&quot; rel=&quot;nofollow noreferrer external&quot; href=&quot;https:&#x2F;&#x2F;github.com&#x2F;docker&#x2F;compose&#x2F;issues&#x2F;4926&quot;&gt;Docker Compose apparently can&#x27;t&lt;&#x2F;a&gt; unless you specify it as an absolute path. I think this will break if you try to run &lt;code&gt;docker compose&lt;&#x2F;code&gt; from another directory, but it&#x27;s good enough for now.&lt;&#x2F;p&gt;
&lt;p&gt;Now let&#x27;s take a look at the &lt;code&gt;Dockerfile&lt;&#x2F;code&gt; itself:&lt;&#x2F;p&gt;
&lt;pre class=&quot;giallo&quot; style=&quot;color: #D8DEE9; background-color: #2E3440;&quot;&gt;&lt;code data-lang=&quot;docker&quot;&gt;&lt;span class=&quot;giallo-l&quot;&gt;&lt;span style=&quot;color: #81A1C1;&quot;&gt;FROM&lt;&#x2F;span&gt;&lt;span&gt; golang:1.25-alpine3.23 &lt;&#x2F;span&gt;&lt;span style=&quot;color: #81A1C1;&quot;&gt;AS&lt;&#x2F;span&gt;&lt;span&gt; builder&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;
&lt;span class=&quot;giallo-l&quot;&gt;&lt;&#x2F;span&gt;
&lt;span class=&quot;giallo-l&quot;&gt;&lt;span style=&quot;color: #81A1C1;&quot;&gt;WORKDIR&lt;&#x2F;span&gt;&lt;span&gt; &#x2F;build&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;
&lt;span class=&quot;giallo-l&quot;&gt;&lt;&#x2F;span&gt;
&lt;span class=&quot;giallo-l&quot;&gt;&lt;span style=&quot;color: #81A1C1;&quot;&gt;ARG&lt;&#x2F;span&gt;&lt;span&gt; CGO_ENABLED=0&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;
&lt;span class=&quot;giallo-l&quot;&gt;&lt;&#x2F;span&gt;
&lt;span class=&quot;giallo-l&quot;&gt;&lt;span style=&quot;color: #81A1C1;&quot;&gt;ARG&lt;&#x2F;span&gt;&lt;span&gt; GOCACHE=&#x2F;root&#x2F;.cache&#x2F;go-build&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;
&lt;span class=&quot;giallo-l&quot;&gt;&lt;span style=&quot;color: #81A1C1;&quot;&gt;ARG&lt;&#x2F;span&gt;&lt;span&gt; GOMODCACHE=&#x2F;root&#x2F;.cache&#x2F;go-mod&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;
&lt;span class=&quot;giallo-l&quot;&gt;&lt;&#x2F;span&gt;
&lt;span class=&quot;giallo-l&quot;&gt;&lt;span style=&quot;color: #81A1C1;&quot;&gt;RUN&lt;&#x2F;span&gt;&lt;span&gt; --mount=type=cache,target=&#x2F;root&#x2F;.cache&#x2F;go-build \&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;
&lt;span class=&quot;giallo-l&quot;&gt;&lt;span&gt;  --mount=type=cache,target=&#x2F;root&#x2F;.cache&#x2F;go-mod \&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;
&lt;span class=&quot;giallo-l&quot;&gt;&lt;span&gt;  --mount=type=bind,source=.,target=&#x2F;build \&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;
&lt;span class=&quot;giallo-l&quot;&gt;&lt;span&gt;  go build -tags=&lt;&#x2F;span&gt;&lt;span style=&quot;color: #A3BE8C;&quot;&gt;&amp;#39;no_clickhouse no_libsql no_sqlite3 no_mssql no_vertica no_mysql no_ydb&amp;#39;&lt;&#x2F;span&gt;&lt;span&gt; -o &#x2F;goose .&#x2F;cmd&#x2F;goose&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;
&lt;span class=&quot;giallo-l&quot;&gt;&lt;&#x2F;span&gt;
&lt;span class=&quot;giallo-l&quot;&gt;&lt;span style=&quot;color: #81A1C1;&quot;&gt;FROM&lt;&#x2F;span&gt;&lt;span&gt; scratch&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;
&lt;span class=&quot;giallo-l&quot;&gt;&lt;&#x2F;span&gt;
&lt;span class=&quot;giallo-l&quot;&gt;&lt;span style=&quot;color: #81A1C1;&quot;&gt;COPY&lt;&#x2F;span&gt;&lt;span&gt; --from=builder &#x2F;goose &#x2F;goose&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;
&lt;span class=&quot;giallo-l&quot;&gt;&lt;&#x2F;span&gt;
&lt;span class=&quot;giallo-l&quot;&gt;&lt;span style=&quot;color: #81A1C1;&quot;&gt;CMD&lt;&#x2F;span&gt;&lt;span&gt; [&lt;&#x2F;span&gt;&lt;span style=&quot;color: #A3BE8C;&quot;&gt;&amp;quot;&#x2F;goose&amp;quot;&lt;&#x2F;span&gt;&lt;span&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color: #A3BE8C;&quot;&gt;&amp;quot;up&amp;quot;&lt;&#x2F;span&gt;&lt;span&gt;]&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;A few things to note:&lt;&#x2F;p&gt;
&lt;ul&gt;
&lt;li&gt;I used the Alpine image for Go because it&#x27;s the smallest and it includes everything I need to build the tool.&lt;&#x2F;li&gt;
&lt;li&gt;I set &lt;code&gt;CGO_ENABLED=0&lt;&#x2F;code&gt; to ensure that the executable only builds with the Go toolchain and does not link to libc. According to &lt;a class=&quot;external-link&quot; rel=&quot;nofollow noreferrer external&quot; href=&quot;https:&#x2F;&#x2F;pkg.go.dev&#x2F;cmd&#x2F;cgo&quot;&gt;the docs&lt;&#x2F;a&gt;, &lt;em&gt;The cgo tool is enabled by default for native builds on systems where it is expected to work&lt;&#x2F;em&gt; so you have to take extra care to disable it if you don&#x27;t want or need it.&lt;&#x2F;li&gt;
&lt;li&gt;I set &lt;code&gt;GOCACHE&lt;&#x2F;code&gt; and &lt;code&gt;GOMODCACHE&lt;&#x2F;code&gt; (&lt;a class=&quot;external-link&quot; rel=&quot;nofollow noreferrer external&quot; href=&quot;https:&#x2F;&#x2F;pkg.go.dev&#x2F;cmd&#x2F;go#hdr-Environment_variables&quot;&gt;docs&lt;&#x2F;a&gt;) to a known location to ensure that I can take advantage of &lt;a class=&quot;external-link&quot; rel=&quot;nofollow noreferrer external&quot; href=&quot;https:&#x2F;&#x2F;docs.docker.com&#x2F;build&#x2F;cache&#x2F;optimize&#x2F;#use-cache-mounts&quot;&gt;cache mounts&lt;&#x2F;a&gt; on subsequent rebuilds. Admittedly this is not very useful for an external tool that I&#x27;m only expecting to build once but hey, every little bit helps.&lt;&#x2F;li&gt;
&lt;li&gt;Instead of &lt;code&gt;ADD&lt;&#x2F;code&gt;ing or &lt;code&gt;COPY&lt;&#x2F;code&gt;ing the package&#x27;s source I &lt;a class=&quot;external-link&quot; rel=&quot;nofollow noreferrer external&quot; href=&quot;https:&#x2F;&#x2F;docs.docker.com&#x2F;build&#x2F;cache&#x2F;optimize&#x2F;#use-bind-mounts&quot;&gt;bind mounted&lt;&#x2F;a&gt; it to the workdir. This should make it a bit faster because it avoids an extra copy into the build container.&lt;&#x2F;li&gt;
&lt;li&gt;&lt;code&gt;FROM scratch&lt;&#x2F;code&gt; defines a &lt;a class=&quot;external-link&quot; rel=&quot;nofollow noreferrer external&quot; href=&quot;https:&#x2F;&#x2F;docs.docker.com&#x2F;build&#x2F;building&#x2F;multi-stage&#x2F;&quot;&gt;second build stage&lt;&#x2F;a&gt; that ensures any artifacts from the actual build are discarded. &lt;a class=&quot;external-link&quot; rel=&quot;nofollow noreferrer external&quot; href=&quot;https:&#x2F;&#x2F;hub.docker.com&#x2F;_&#x2F;scratch&#x2F;&quot;&gt;&lt;code&gt;scratch&lt;&#x2F;code&gt;&lt;&#x2F;a&gt; is the null image.&lt;&#x2F;li&gt;
&lt;&#x2F;ul&gt;
&lt;p&gt;The result is an image with one layer containing one file that builds, loads and boots extremely fast and is only &lt;small&gt;&lt;em&gt;*chef&#x27;s kiss*&lt;&#x2F;em&gt;&lt;&#x2F;small&gt; 15.9MB in size. Not too bad!&lt;&#x2F;p&gt;
&lt;p&gt;&lt;img src=&quot;https:&#x2F;&#x2F;sgt.hootr.club&#x2F;blog&#x2F;docker-protips&#x2F;smol-image.png&quot; alt=&quot;Screenshot of dive showing the resulting image&quot; &#x2F;&gt;&lt;&#x2F;p&gt;
&lt;h2 id=&quot;the-build-context&quot;&gt;The build context&lt;&#x2F;h2&gt;
&lt;p&gt;Earlier I mentioned the build context. &lt;a class=&quot;external-link&quot; rel=&quot;nofollow noreferrer external&quot; href=&quot;https:&#x2F;&#x2F;docs.docker.com&#x2F;build&#x2F;cache&#x2F;optimize&#x2F;#keep-the-context-small&quot;&gt;Keeping it small&lt;&#x2F;a&gt; is important because &lt;a class=&quot;external-link&quot; rel=&quot;nofollow noreferrer external&quot; href=&quot;https:&#x2F;&#x2F;docs.docker.com&#x2F;build&#x2F;concepts&#x2F;context&#x2F;#dockerignore-files&quot;&gt;Docker copies all files available in the build context to the builder&lt;&#x2F;a&gt; every time you run a &lt;code&gt;docker build&lt;&#x2F;code&gt;, so if you have lots of files in your repo that you don&#x27;t need to build the image you&#x27;ll probably want to exclude them. The way you do that is by keeping a &lt;code&gt;.dockerignore&lt;&#x2F;code&gt; file alongside your &lt;code&gt;Dockerfile&lt;&#x2F;code&gt;.&lt;&#x2F;p&gt;
&lt;p&gt;I have to stress one point: the build context includes &lt;strong&gt;everything&lt;&#x2F;strong&gt; inside the directory you run &lt;code&gt;docker build&lt;&#x2F;code&gt; from unless it&#x27;s listed in &lt;code&gt;.dockerignore&lt;&#x2F;code&gt;. I thought some obvious things like &lt;code&gt;.git&lt;&#x2F;code&gt; would be excluded by default, but a quick test disproved that:&lt;&#x2F;p&gt;
&lt;pre class=&quot;giallo&quot; style=&quot;color: #D8DEE9; background-color: #2E3440;&quot;&gt;&lt;code data-lang=&quot;docker&quot;&gt;&lt;span class=&quot;giallo-l&quot;&gt;&lt;span style=&quot;color: #81A1C1;&quot;&gt;FROM&lt;&#x2F;span&gt;&lt;span&gt; busybox&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;
&lt;span class=&quot;giallo-l&quot;&gt;&lt;span style=&quot;color: #81A1C1;&quot;&gt;WORKDIR&lt;&#x2F;span&gt;&lt;span&gt; &#x2F;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;
&lt;span class=&quot;giallo-l&quot;&gt;&lt;span style=&quot;color: #81A1C1;&quot;&gt;COPY&lt;&#x2F;span&gt;&lt;span&gt; . .&#x2F;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;
&lt;span class=&quot;giallo-l&quot;&gt;&lt;span style=&quot;color: #81A1C1;&quot;&gt;CMD&lt;&#x2F;span&gt;&lt;span&gt; []&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;Try saving that file as &lt;code&gt;Dockerfile.test&lt;&#x2F;code&gt; in one of your repos, build it with &lt;code&gt;docker build -f Dockerfile.text -t build-context .&lt;&#x2F;code&gt;, open a shell with &lt;code&gt;docker run --rm -it build-context &#x2F;bin&#x2F;sh&lt;&#x2F;code&gt; and run &lt;code&gt;find&lt;&#x2F;code&gt;. Everything&#x27;s in there: &lt;code&gt;.git&lt;&#x2F;code&gt;, &lt;code&gt;.jj&lt;&#x2F;code&gt;, the &lt;code&gt;Dockerfile.test&lt;&#x2F;code&gt; itself, and all the rest of the build artifacts and assorted junk you have accumulated in your project directory. Ignoring them won&#x27;t make your images smaller, but it might make the build quicker.&lt;&#x2F;p&gt;
&lt;pre class=&quot;giallo&quot; style=&quot;color: #D8DEE9; background-color: #2E3440;&quot;&gt;&lt;code data-lang=&quot;plain&quot;&gt;&lt;span class=&quot;giallo-l&quot;&gt;&lt;span&gt;# .dockerignore&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;
&lt;span class=&quot;giallo-l&quot;&gt;&lt;span&gt;.*&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;
&lt;span class=&quot;giallo-l&quot;&gt;&lt;&#x2F;span&gt;
&lt;span class=&quot;giallo-l&quot;&gt;&lt;span&gt;Dockerfile*&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;
&lt;span class=&quot;giallo-l&quot;&gt;&lt;span&gt;docker-compose.yml&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;
&lt;span class=&quot;giallo-l&quot;&gt;&lt;&#x2F;span&gt;
&lt;span class=&quot;giallo-l&quot;&gt;&lt;span&gt;# ...&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;&lt;h2 id=&quot;granular-layers&quot;&gt;Granular layers&lt;&#x2F;h2&gt;
&lt;p&gt;&lt;a class=&quot;external-link&quot; rel=&quot;nofollow noreferrer external&quot; href=&quot;https:&#x2F;&#x2F;docs.docker.com&#x2F;build&#x2F;cache&#x2F;optimize&#x2F;#order-your-layers&quot;&gt;Splitting and ordering layers&lt;&#x2F;a&gt; is probably the most well-known and obvious Docker build time optimization there is, but it doesn&#x27;t hurt to mention. This is the &lt;code&gt;Dockerfile&lt;&#x2F;code&gt; for the service I&#x27;m building:&lt;&#x2F;p&gt;
&lt;pre class=&quot;giallo&quot; style=&quot;color: #D8DEE9; background-color: #2E3440;&quot;&gt;&lt;code data-lang=&quot;docker&quot;&gt;&lt;span class=&quot;giallo-l&quot;&gt;&lt;span style=&quot;color: #81A1C1;&quot;&gt;FROM&lt;&#x2F;span&gt;&lt;span&gt; golang:1.25-alpine3.23 &lt;&#x2F;span&gt;&lt;span style=&quot;color: #81A1C1;&quot;&gt;AS&lt;&#x2F;span&gt;&lt;span&gt; builder&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;
&lt;span class=&quot;giallo-l&quot;&gt;&lt;&#x2F;span&gt;
&lt;span class=&quot;giallo-l&quot;&gt;&lt;span style=&quot;color: #81A1C1;&quot;&gt;WORKDIR&lt;&#x2F;span&gt;&lt;span&gt; &#x2F;build&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;
&lt;span class=&quot;giallo-l&quot;&gt;&lt;&#x2F;span&gt;
&lt;span class=&quot;giallo-l&quot;&gt;&lt;span style=&quot;color: #81A1C1;&quot;&gt;ARG&lt;&#x2F;span&gt;&lt;span&gt; CGO_ENABLED=0&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;
&lt;span class=&quot;giallo-l&quot;&gt;&lt;&#x2F;span&gt;
&lt;span class=&quot;giallo-l&quot;&gt;&lt;span style=&quot;color: #81A1C1;&quot;&gt;ARG&lt;&#x2F;span&gt;&lt;span&gt; GOCACHE=&#x2F;root&#x2F;.cache&#x2F;go-build&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;
&lt;span class=&quot;giallo-l&quot;&gt;&lt;span style=&quot;color: #81A1C1;&quot;&gt;ARG&lt;&#x2F;span&gt;&lt;span&gt; GOMODCACHE=&#x2F;root&#x2F;.cache&#x2F;go-mod&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;
&lt;span class=&quot;giallo-l&quot;&gt;&lt;&#x2F;span&gt;
&lt;span class=&quot;giallo-l&quot;&gt;&lt;span style=&quot;color: #81A1C1;&quot;&gt;RUN&lt;&#x2F;span&gt;&lt;span&gt; --mount=type=cache,target=&#x2F;root&#x2F;.cache&#x2F;go-build \&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;
&lt;span class=&quot;giallo-l&quot;&gt;&lt;span&gt;  --mount=type=cache,target=&#x2F;root&#x2F;.cache&#x2F;go-mod \&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;
&lt;span class=&quot;giallo-l&quot;&gt;&lt;span&gt;  go install github.com&#x2F;DataDog&#x2F;orchestrion@latest&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;
&lt;span class=&quot;giallo-l&quot;&gt;&lt;&#x2F;span&gt;
&lt;span class=&quot;giallo-l&quot;&gt;&lt;span style=&quot;color: #81A1C1;&quot;&gt;RUN&lt;&#x2F;span&gt;&lt;span&gt; --mount=type=bind,source=go.mod,target=go.mod \&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;
&lt;span class=&quot;giallo-l&quot;&gt;&lt;span&gt;  --mount=type=bind,source=go.sum,target=go.sum \&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;
&lt;span class=&quot;giallo-l&quot;&gt;&lt;span&gt;  --mount=type=cache,target=&#x2F;root&#x2F;.cache&#x2F;go-build \&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;
&lt;span class=&quot;giallo-l&quot;&gt;&lt;span&gt;  --mount=type=cache,target=&#x2F;root&#x2F;.cache&#x2F;go-mod \&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;
&lt;span class=&quot;giallo-l&quot;&gt;&lt;span&gt;  go mod download&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;
&lt;span class=&quot;giallo-l&quot;&gt;&lt;&#x2F;span&gt;
&lt;span class=&quot;giallo-l&quot;&gt;&lt;span style=&quot;color: #81A1C1;&quot;&gt;RUN&lt;&#x2F;span&gt;&lt;span&gt; --mount=type=bind,source=go.mod,target=go.mod \&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;
&lt;span class=&quot;giallo-l&quot;&gt;&lt;span&gt;  --mount=type=bind,source=go.sum,target=go.sum \&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;
&lt;span class=&quot;giallo-l&quot;&gt;&lt;span&gt;  --mount=type=cache,target=&#x2F;root&#x2F;.cache&#x2F;go-build \&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;
&lt;span class=&quot;giallo-l&quot;&gt;&lt;span&gt;  --mount=type=cache,target=&#x2F;root&#x2F;.cache&#x2F;go-mod \&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;
&lt;span class=&quot;giallo-l&quot;&gt;&lt;span&gt;  --mount=type=bind,source=internal,target=internal \&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;
&lt;span class=&quot;giallo-l&quot;&gt;&lt;span&gt;  --mount=type=bind,source=cmd,target=cmd \&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;
&lt;span class=&quot;giallo-l&quot;&gt;&lt;span&gt;  --mount=type=bind,source=orchestrion.tool.go,target=orchestrion.tool.go \&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;
&lt;span class=&quot;giallo-l&quot;&gt;&lt;span&gt;  orchestrion go build -o server .&#x2F;cmd&#x2F;server&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;
&lt;span class=&quot;giallo-l&quot;&gt;&lt;&#x2F;span&gt;
&lt;span class=&quot;giallo-l&quot;&gt;&lt;span style=&quot;color: #81A1C1;&quot;&gt;FROM&lt;&#x2F;span&gt;&lt;span&gt; alpine:3.23 &lt;&#x2F;span&gt;&lt;span style=&quot;color: #81A1C1;&quot;&gt;AS&lt;&#x2F;span&gt;&lt;span&gt; prod&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;
&lt;span class=&quot;giallo-l&quot;&gt;&lt;&#x2F;span&gt;
&lt;span class=&quot;giallo-l&quot;&gt;&lt;span style=&quot;color: #81A1C1;&quot;&gt;WORKDIR&lt;&#x2F;span&gt;&lt;span&gt; &#x2F;app&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;
&lt;span class=&quot;giallo-l&quot;&gt;&lt;&#x2F;span&gt;
&lt;span class=&quot;giallo-l&quot;&gt;&lt;span style=&quot;color: #81A1C1;&quot;&gt;COPY&lt;&#x2F;span&gt;&lt;span&gt; --from=builder &#x2F;build&#x2F;server .&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;
&lt;span class=&quot;giallo-l&quot;&gt;&lt;&#x2F;span&gt;
&lt;span class=&quot;giallo-l&quot;&gt;&lt;span style=&quot;color: #81A1C1;&quot;&gt;ENTRYPOINT&lt;&#x2F;span&gt;&lt;span&gt; [&lt;&#x2F;span&gt;&lt;span style=&quot;color: #A3BE8C;&quot;&gt;&amp;quot;&#x2F;app&#x2F;server&amp;quot;&lt;&#x2F;span&gt;&lt;span&gt;]&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;You can see all the bind and cache mount tricks from earlier, not much has changed. I&#x27;m installing &lt;a class=&quot;external-link&quot; rel=&quot;nofollow noreferrer external&quot; href=&quot;https:&#x2F;&#x2F;github.com&#x2F;DataDog&#x2F;orchestrion&quot;&gt;&lt;code&gt;orchestrion&lt;&#x2F;code&gt;&lt;&#x2F;a&gt; (a great tool to bloat up your binary size if you ever feel like it) early because that&#x27;s the least likely to change. After that I bind mount &lt;code&gt;go.mod&lt;&#x2F;code&gt; and &lt;code&gt;go.sum&lt;&#x2F;code&gt; and only download the dependencies, because that&#x27;s the step that generally takes the most time and dependencies change less often than code. Only at the end do I bind mount the package directories and build the server.&lt;&#x2F;p&gt;
&lt;aside class=&quot;note&quot;&gt;
  &lt;p&gt;I opted for good ol&#x27; Alpine for the base final image. It only adds a couple more MBs and I&#x27;m sure whoever will eventually have to shell into a prod container will appreciate having something to work with.&lt;&#x2F;p&gt;

&lt;&#x2F;aside&gt;
&lt;p&gt;You can iterate on this by changing one of the relevant files and ensuring that all the previous steps are marked as &lt;code&gt;CACHED&lt;&#x2F;code&gt; on the next &lt;code&gt;docker build&lt;&#x2F;code&gt;. Again, this won&#x27;t save you space but it&#x27;ll save you a lot of time while iterating.&lt;&#x2F;p&gt;
&lt;h2 id=&quot;conclusions&quot;&gt;Conclusions&lt;&#x2F;h2&gt;
&lt;p&gt;Summing up:&lt;&#x2F;p&gt;
&lt;ul&gt;
&lt;li&gt;Read the &lt;a class=&quot;external-link&quot; rel=&quot;nofollow noreferrer external&quot; href=&quot;https:&#x2F;&#x2F;docs.docker.com&#x2F;build&#x2F;cache&#x2F;optimize&#x2F;&quot;&gt;Optimize cache usage in builds&lt;&#x2F;a&gt; page in the Docker documentation, and maybe take a look at the rest while you&#x27;re there.&lt;&#x2F;li&gt;
&lt;li&gt;Split, merge and order layers according to how often you expect them to be rebuilt. Directives like &lt;code&gt;ENV&lt;&#x2F;code&gt;, &lt;code&gt;ARG&lt;&#x2F;code&gt; and &lt;code&gt;WORKDIR&lt;&#x2F;code&gt; should go before everything else.&lt;&#x2F;li&gt;
&lt;li&gt;Use &lt;a class=&quot;external-link&quot; rel=&quot;nofollow noreferrer external&quot; href=&quot;https:&#x2F;&#x2F;docs.docker.com&#x2F;build&#x2F;building&#x2F;multi-stage&#x2F;&quot;&gt;multi-stage builds&lt;&#x2F;a&gt; to shrink the final image size. Consider if you can get away with using &lt;code&gt;scratch&lt;&#x2F;code&gt;, &lt;code&gt;busybox&lt;&#x2F;code&gt; or &lt;code&gt;alpine&lt;&#x2F;code&gt; for the final image.&lt;&#x2F;li&gt;
&lt;li&gt;If your project contains multiple separate applications (for example a backend and a frontend) you can create separate build stages for each of them, and then copy the results into a final image. Stages that don&#x27;t depend on each other &lt;a class=&quot;external-link&quot; rel=&quot;nofollow noreferrer external&quot; href=&quot;https:&#x2F;&#x2F;docs.docker.com&#x2F;build&#x2F;buildkit&#x2F;&quot;&gt;are built in parallel if you&#x27;re using BuildKit&lt;&#x2F;a&gt;, and you can do &lt;a class=&quot;external-link&quot; rel=&quot;nofollow noreferrer external&quot; href=&quot;https:&#x2F;&#x2F;medium.com&#x2F;@tonistiigi&#x2F;advanced-multi-stage-build-patterns-6f741b852fae&quot;&gt;all sorts of tricks&lt;&#x2F;a&gt; with multi-stage builds to ensure your CPU runs hot all the time.&lt;&#x2F;li&gt;
&lt;li&gt;Add a &lt;code&gt;.dockerignore&lt;&#x2F;code&gt; to your project, and make sure to put &lt;code&gt;.git&lt;&#x2F;code&gt; in there if you don&#x27;t need it.&lt;&#x2F;li&gt;
&lt;li&gt;Try to set up cache mounts to make sure dependencies and intermediate build artifacts are persisted across builds. Some CI services (GitHub actions, apparently) even let you set up &lt;a class=&quot;external-link&quot; rel=&quot;nofollow noreferrer external&quot; href=&quot;https:&#x2F;&#x2F;docs.docker.com&#x2F;build&#x2F;cache&#x2F;optimize&#x2F;#use-an-external-cache&quot;&gt;external caches&lt;&#x2F;a&gt;.&lt;&#x2F;li&gt;
&lt;li&gt;Try to use bind mounts instead of &lt;code&gt;COPY&lt;&#x2F;code&gt;ing source files into the builder. Bind mounts are usually read-only, but you can make them read-write if you really need to.&lt;&#x2F;li&gt;
&lt;li&gt;I didn&#x27;t use it in my &lt;code&gt;Dockerfile&lt;&#x2F;code&gt;s, but apparently you should be using &lt;code&gt;ADD&lt;&#x2F;code&gt; for downloading files, archives or Git repos during your build. &lt;a class=&quot;external-link&quot; rel=&quot;nofollow noreferrer external&quot; href=&quot;https:&#x2F;&#x2F;docs.docker.com&#x2F;build&#x2F;building&#x2F;best-practices&#x2F;#add-or-copy&quot;&gt;The docs&lt;&#x2F;a&gt; mention that &lt;code&gt;COPY&lt;&#x2F;code&gt; should mostly be used for copying files between stages or for files you need in your final image, and for the rest you should try to use bind mounts.&lt;&#x2F;li&gt;
&lt;li&gt;Use smaller base images when possible and if you &lt;em&gt;really&lt;&#x2F;em&gt; have to install stuff with &lt;code&gt;apt&lt;&#x2F;code&gt; you should make an intermediate image and upload it to your container repository of choice so your poor runners don&#x27;t have to hammer Debian&#x27;s mirrors every single time you push.&lt;&#x2F;li&gt;
&lt;&#x2F;ul&gt;
&lt;p&gt;One last trick before the post is over: I just discovered that Docker Compose &lt;a class=&quot;external-link&quot; rel=&quot;nofollow noreferrer external&quot; href=&quot;https:&#x2F;&#x2F;docs.docker.com&#x2F;compose&#x2F;how-tos&#x2F;file-watch&#x2F;&quot;&gt;has a watch mode&lt;&#x2F;a&gt; that tracks changes in the build context and rebuilds (or does other things with) your image on every change. Nice!&lt;&#x2F;p&gt;
</description>
      </item>
    </channel>
</rss>
