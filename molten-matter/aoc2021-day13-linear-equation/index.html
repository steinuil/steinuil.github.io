<html><head><meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" /><title>Solving Advent of Code 2021 Day 13 with a linear equation</title><meta name="description" content="steenuil's blog" /><meta name="generator" content="generator.rkt" /><meta name="referrer" content="strict-origin" /><link rel="stylesheet" href="/assets/style.css" type="text/css" /><link rel="alternate" href="/rss.xml" type="application/rss+xml" title="RSS feed" /><link rel="alternate" href="/feed.xml" type="application/atom+xml" title="Atom feed" /><link rel="apple-touch-icon-precomposed" href="/assets/icon/favicon-152.png" /><meta name="og:type" content="website" /><meta name="og:title" content="Solving Advent of Code 2021 Day 13 with a linear equation" /><meta name="og:description" content="steenuil's blog" /><meta name="twitter:card" content="summary" /><meta name="twitter:site" content="@steinuil" /><meta name="twitter:creator" content="@steinuil" /><meta name="twitter:dnt" content="on" /></head><body id="blog-post-page"><div class="body-container"><header><nav><ul><li><a href="/molten-matter/">Molten Matter</a></li><li><a href="/">About</a></li><li><a href="/legal/">Legal</a></li></ul></nav></header><main><header><h1 class="post-title">Solving Advent of Code 2021 Day 13 with a linear equation</h1> <time datetime="2021-12-13">2021/12/13</time></header><div class="text"><p>This year I&rsquo;m doing Advent of Code in Erlang. The data structures it provides are all immutable, so I have to be kinda clever if I don&rsquo;t want my solutions to run too slowly. This is my solution for <a href="https://adventofcode.com/2021/day/13">Day 13: Transparent Origami</a>.</p><p>The first thing I noticed when I got the input was that all the folds are right down the middle, so I figured that instead of doing all the folds iteratively you could get the final position of a point on the paper just knowing the X and Y of the point and the X and Y offsets of the last folds.</p><p>Imagine that you have a 15x11 piece of paper.</p></div><pre><code>...............
...............
...............
...............
...............
...............
...............
...............
...............
...............
...............</code></pre><div class="text"><p>And that the instructions tell you to:</p></div><ul><li>fold along y=5</li><li>fold along x=7</li><li>fold along y=2</li><li>fold along x=3</li></ul><div class="text"><p>If you were to fold that piece of paper following the instructions and then unfold it, you&rsquo;d get a grid of 3x2 rectangles with a line of crease between each of them. Notice that the width and height of the rectangles are the same as the last x and y the paper was folded along.</p></div><pre><code>...|...|...|...
...|...|...|...
---+---+---+---
...|...|...|...
...|...|...|...
---+---+---+---
...|...|...|...
...|...|...|...
---+---+---+---
...|...|...|...
...|...|...|...</code></pre><div class="text"><p>The key thing here is understanding how these rectangles will end up looking when the whole piece of paper is folded. The top left rectangle is unchanged, but the next one on the right will be <em>flipped horizontally</em>, and the next one on the right will be unchanged again. The first rectangle down from the top left will be <em>flipped vertically</em>, and the one on its right will end up <em>rotated by 180 degrees</em>, because it&rsquo;ll be flipped both horizontally and vertically.</p><p>Here&rsquo;s a visualization, where u = unchanged, h = flipped horizontally, v = flipped vertically and r = flipped both directions.</p></div><pre><code>uuu|hhh|uuu|hhh
uuu|hhh|uuu|hhh
---+---+---+---
vvv|rrr|vvv|rrr
vvv|rrr|vvv|rrr
---+---+---+---
uuu|hhh|uuu|hhh
uuu|hhh|uuu|hhh
---+---+---+---
vvv|rrr|vvv|rrr
vvv|rrr|vvv|rrr</code></pre><div class="text"><p>So if you want to get the final X coordinate of a point in the 3rd rectangle right from the top left (the one at 2,0, if the first rectangle is 0,0), for example 10,0, you&rsquo;d have to subtract the number of creases between that and the first rectangle, in this case 2, and then modulo by the width of the rectangle, which is 3, which gives you 2.</p></div><pre><code>x = 10
width = 3
creases = 2
final_x = (x - creases) % width</code></pre><div class="text"><p>If you want to get the final X coordinate of a point in the 2nd rectangle though, for example 0,4, you&rsquo;d have to perform the same operations as above and then subtract it from the width of the rectangle minus 1, since the rectangle is flipped horizontally.</p></div><pre><code>final_x = width - ((x - creases) % width) - 1</code></pre><div class="text"><p>What I did at this point was go on Wolfram Alpha to try and figure out a formula for getting the number of creases given a certain X. I&rsquo;m sure you can find that out somehow. I didn&rsquo;t, but what I noticed was that the function I described above formed a certain shape&hellip;</p></div><pre><code> |
 | 2 2     2 2     2
 |1   1   1   1   1
-0-----0-0-----0-0--
 |</code></pre><div class="text"><p>If you plot the input X as the X of the graph and the expected output numbers as the Y, you get this funny looking graph as a result. If you want to know what position a certain number will end up in, just walk the X that many times and find the number at that position.</p><p>Some X positions are empty because that&rsquo;s where the creases are. If you put some pointy tips on those positions you&rsquo;d end up with a proper <strong>triangle wave</strong>.</p></div><pre><code> |
 |  ^       ^       ^
 | / \     / \     /
 |/   \   /   \   /
-/-----\-/-----\-/---
v|      v       v
 |</code></pre><div class="text"><p>So how do we use this knowledge to solve Day 13 of Advent of Code 2021? Well, you could look at the explanation on Wikipedia and translate the general formula into your favourite language, but that implies you can read math notation. Or you could google &ldquo;triangle wave function programming&rdquo; and find <a href="https://stackoverflow.com/questions/1073606/is-there-a-one-line-function-that-generates-a-triangle-wave/22400799#22400799">this StackOverflow answer</a> and then copy and paste that in your code.</p></div><pre><code>y = (A/P) * (P - abs(x % (2*P) - P))</code></pre><div class="text"><p>Since the amplitude and the period of the wave are the same (we always advance by 1) we can get rid of the first division. You&rsquo;ll also notice that the graph of the function for the width of the rectangle goes from &ndash;1 to 3 (an interval of 4), so we&rsquo;ll have to add 1 to both the width and the X to use this, and in the end we&rsquo;ll have to subtract 1 from the output to return it to the 0..2 interval we need.</p><p>This is what I ended up with:</p></div><pre><code>x += 1
width += 1
final_x = (width - abs(x % (2 * width) - width)) - 1</code></pre><div class="text"><p>It runs pretty quickly <a href="https://github.com/steinuil/code-challenges/blob/master/advent-of-code-2021/day_13.erl">even in Erlang</a>.</p></div></main><footer>made with <a href="https://racket-lang.org/">racket</a> :: <a href="/rss.xml">rss</a> :: <a href="/feed.xml">atom</a></footer></div></body></html>