<html><head><title>What the hell did I do this week, anyway?</title><meta charset="UTF-8" /><meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" /><link rel="stylesheet" href="/assets/style.css" type="text/css" /></head><body id="blog-post-page"><div class="body-container"><header><nav><ul><li><a href="/molten-matter/">Molten Matter</a></li><li><a href="/">About</a></li><li><a href="/legal/">Legal</a></li></ul></nav></header><main><header><div class="post-title">What the hell did I do this week, anyway?</div><time datetime="2018-01-29">2018/01/29</time></header><div class="text"><p>Welcome to the first installation of <strong>What The Hell Did I Do This Week Anyway</strong>, the low-effort blog series where I write about random stuff that I did in the last few days.</p></div><header class="heading" id="emacs-strikes-again-or-the-stages-of-software-grief">Emacs strikes again, or the stages of software grief</header><div class="text"><p>This week I watched a bunch of Jonathan Blow&rsquo;s <a href="https://www.youtube.com/user/jblow888/videos">screencasts</a>, where he talks about the language he&rsquo;s writing and all that business. It looks nice. Lately he&rsquo;s working on libraries, and I wish he&rsquo;d take a hint from ML functors when designing modules and module options, as he&rsquo;s talked about in the libraries discussion stream. Expose a fucking module for configuration and make it return the full thing, using strings for that just feels painful.</p><p>Anyway, he uses emacs for all the programming in his stream, save for debugging a bunch of stuff in C++, and looking at emacs for all this time has reawakened the little bug in my brain that tells me to start using emacs already. I use nvim for everything, but I&rsquo;m kind of horrified by the whole vimscript business and at the very least elisp is a saner language.<br />Screw learning all those keybinds though. I&rsquo;ve spent years on vim and I think the modal editing business is a much better fit to editing code than the big mess of emacs keybinds. Screw using evil too, though, because emacs is not vi and I don&rsquo;t think it should be. Screw all the minor modes that kind of mimic vi but also kind of don&rsquo;t, and screw a lot of the packages that emacs comes preloaded with.</p><p>I downloaded the emacs source and managed to compile temacs, which is the &ldquo;bare&rdquo; version of emacs that gets filled in with all the preloaded libraries and elisp code, and then gets &ldquo;dumped&rdquo; to the final emacs executable we all know and fear. I recommend <a href="http://emacshorrors.com/posts/unexecute.html">this</a> for the gory details on this horrifying process. I think there might be a few steps in the build process that should happen after building temacs but before actually loading temacs and dumping it to emacs, because I can&rsquo;t get the damn thing to work. I invoke temacs and tell it to load <code>loadup.el</code> (the file that loads all the plugins and tells emacs to dump itself) but it keeps failing with some error message or another. First it&rsquo;s pcase, then it&rsquo;s require, and who knows what the next will be. Despite its reputation for being so hackable, this part of the build process sure is not, and if it is it&rsquo;s <em>very</em> undocumented.</p><p>I started writing my own loadup file in hopes of getting it right, but I ran into some files that supposedly provide Common Lisp support which for some reason <code>require</code> each other. At this point I gave up, because I was already way past the treshold of time and effort I wanted to allocate to emacs that evening. Thanks, jwz.</p><p>The next step in the stages of software grief is starting to implement your own version, because you&rsquo;re <strong>so</strong> done with whatever you were using before and its alternatives and how hard could it possibly be anyway. Which is exactly what I did, as soon as I remembered that Racket came with a perfectly good library for drawing stuff on the screen, on top of which they implemented a GUI library and the very nice editor/IDE DrRacket. I looked up how Racket implements the editor window, and the results weren&rsquo;t exactly what I&rsquo;d call readable or encouragings, after messing a bit with the <code>canvas%</code> class I decided to give up for the moment.</p><p>Which is where I reached the last stage of software grief, in which I changed my vim colorscheme to <a href="https://github.com/ajmwagar/vim-deus">deus</a> and called it a day.</p></div><header class="heading" id="eight-whole-bytes-of-security">Eight whole bytes of security</header><div class="text"><p>I was working on my Ur/Web imageboard, when I noticed that I accidentally typed &ldquo;passwords&rdquo; instead of &ldquo;password&rdquo; and still managed to log in. I looked up the implementation of <code>crypt</code> (the only password hashing function provided in Ur/Web) in the runtime library and discovered that it uses OpenSSL&rsquo;s <code>DES_crypt</code>, which clips passwords to 8 characters (!) and has been deemed obsolete for decades now (with good reason). I don&rsquo;t know what the production-class Ur/Web applications do for password hashing, but thankfully searching for <code>crypt</code> in both the Bazqux Reader and UPO repos doesn&rsquo;t turn up any results. Either way, nobody had bothered to write Ur/Web bindings to a better password hashing algorithm, so I figured I&rsquo;d do it.</p><p>The result is <a href="https://github.com/steinuil/urweb-bcrypt">this library</a>, which uses Solar Designer&rsquo;s implementation of the algorithm. It only exposes two functions, so integrating it with my imageboard only took something like two minutes. I&rsquo;m quite satisfied with it, though it could probably use some tests.</p><p>The other result is that I&rsquo;ve submitted a PR with a comment on the <code>crypt</code> function in the Ur/Web standard library, essentially explaining that it&rsquo;s insecure and you should probably consider an alternative (such as my library).</p></div></main><footer>this web sight made with <a href="https://racket-lang.org/">Racket</a>.</footer></div></body></html>